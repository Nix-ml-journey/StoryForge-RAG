# summarization prompts for the data_merge.py
summarization:
  chunk_summary: |
    Summarize this part in 2-3 sentences, keeping chronological order and key events.
    Part:
    {story_part}

  refine_summary: |
    Write a concise summary of about 100 words in chronological order.
    Cover the beginning, middle, and end.
    Merge the parts smoothly and avoid repetition or copied phrases.
    Do not include labels like 'Part 1'.
    Parts:
    {summary_text}

  # Batched multi-file: one request for multiple stories, JSON response
  batch_summary: |
    You are a story summarizer. Below are multiple story texts, each labeled with an id.
    Summarize EACH story in about 100 words, in chronological order. Cover beginning, middle, and end.
    Merge events smoothly and avoid repetition or copied phrases.
    Return ONLY a valid JSON object with this exact structure (no other text):
    {{
      "summaries": [
        {{ "id": "<story_id>", "summary": "<your summary text>" }},
        ...
      ]
    }}
    Use the exact id given for each story (e.g. "PETER BREAKS THROUGH") in the "id" field.

    STORIES:
    {batched_stories}

# story generation prompts for the generative_ai.py
generation:
  # System prompt for story summarization
  summary_system: |
    You are a story summarizer. Based on the provided context,
    create a concise summary that captures the key events and themes.
    Keep it brief (2-3 paragraphs) and in chronological order.

  # User prompt template for summary
  summary_user: |
    Context from stories:
    {context}

    User Query: {query}

    Please provide a summary based on the above context.

  # ─── Single-pass generation (fallback when Two_pass_generation is false) ───

  full_story_system: |
    You are a master storyteller. You will receive reference material from classic literature
    followed by a writing request. Your job is to write an ORIGINAL story inspired by that material.

    ## Voice and Style
    The reference material is from old books (1800s-1900s). Do NOT imitate that style.
    Write in a modern, accessible voice like contemporary fiction or modern fairy-tale retellings.
    - Use natural-sounding dialogue that reveals character personality.
    - Use clear action verbs instead of passive constructions.
    - Use vivid sensory details: what characters see, hear, smell, and feel.
    - Avoid archaic words like "whereupon", "thus", "henceforth", "forthwith".
    - Avoid stacking multiple adjectives or adverbs in one phrase.

    ## Structure
    - Begin with a strong opening sentence that hooks the reader.
    - End with a definitive concluding sentence. Never trail off or end mid-thought.
    - Every scene change must connect to the previous scene through a character's action or decision.
    - Write at least 5 paragraphs covering a full story arc: setup, conflict, climax, resolution.

    ## Quality
    - Use short and medium-length sentences. Never write a paragraph as a single run-on sentence.
    - Vary sentence structure: mix action, dialogue, and description.
    - Keep descriptions tight — one or two vivid details per sentence, not five.
    - The final paragraph must be as carefully written as the first. Do not rush the ending.

    ## Output
    - Output ONLY the story prose. No titles, author names, "Title:", "Content:", separators, or metadata.
    - Do not copy passages from the reference material. Use it only as inspiration.

  full_story_user: |
    Below is reference material for inspiration. Do NOT copy it.
    Use it to understand characters, settings, and tone — then create something new.

    [REFERENCE MATERIAL BEGIN]
    {context}
    [REFERENCE MATERIAL END]

    Writing request: {query}

    Write an original story based on the request above.
    Requirements:
    - Start with a strong opening sentence.
    - Include dialogue between characters.
    - Cover a full arc: setup, conflict, climax, and resolution.
    - End with a clear, short concluding sentence — not a trailing thought.
    - Output only the story text, nothing else.

  # ─── Two-pass generation prompts ───

  # Pass 1: Build a story outline from reference material
  outline_system: |
    You are a story architect. You will receive reference material and a writing request.
    Your job is to create a structured OUTLINE for an original story inspired by that material.

    ## What to include
    1. Setting: A specific place and time period. Not generic ("a forest") — be concrete
       ("a fog-covered fishing village on the Baltic coast, late autumn").
    2. Characters: 2-4 named characters. For each, give one distinctive personality trait
       and one clear motivation or goal.
    3. Plot beats: exactly 5 numbered beats covering the full arc:
       1. Opening hook (what draws the reader in and establishes the status quo)
       2. Inciting incident (what disrupts the status quo and sets the story in motion)
       3. Rising action with a twist (tension escalates, then something unexpected happens)
       4. Climax (the decisive moment where the main conflict is confronted)
       5. Resolution (how the story settles, what changed for the characters)
    4. Each beat must be one concrete sentence describing what happens, not a vague label
       like "things get worse". Say what actually happens.

    ## Output rules
    - Keep the outline under 250 words.
    - Output ONLY the outline in plain text. No prose, no commentary, no preamble.

  outline_user: |
    Below is reference material from existing stories. Study the characters, settings,
    themes, and story patterns — then plan an original story inspired by them.

    [REFERENCE MATERIAL BEGIN]
    {context}
    [REFERENCE MATERIAL END]

    Writing request: {query}

    Create a story outline with:
    - A specific setting (place and time)
    - 2-4 named characters with distinct traits and motivations
    - Exactly 5 numbered plot beats: hook, inciting incident, rising action + twist, climax, resolution
    - At least one unexpected twist the reader would not predict from the setup

    Output only the outline.

  # Pass 2: Expand outline into full story
  story_from_outline_system: |
    You are a master storyteller. You will receive a story outline and a writing request.
    Your job is to expand every plot beat into vivid, engaging prose — a complete story.

    ## Voice and Style
    Write in a modern, accessible voice like contemporary fiction or modern retellings.
    - Use natural-sounding dialogue that reveals character personality.
      Good: "You can't be serious," she said, folding her arms.
      Bad: "Pray tell, what madness doth thou speak of?" she exclaimed most vehemently.
    - Use clear action verbs: "She grabbed the rope" not "The rope was taken hold of by her."
    - Use vivid sensory details: what characters see, hear, smell, touch, and feel emotionally.
    - Avoid archaic words: "whereupon", "thus", "henceforth", "forthwith", "indeed".
    - Avoid stacking modifiers: "the old dark mysterious ancient crumbling tower" — pick one or two.

    ## Structure
    - Begin with a strong opening sentence that hooks the reader immediately.
    - Every scene change must connect to the previous scene through a character's action or decision.
      Do not jump between disconnected characters without a transition.
    - End with a definitive, clean concluding sentence. Never trail off with "..." or end mid-thought.

    ## Pacing and Completeness
    - You MUST cover ALL plot beats in the outline, from opening through resolution.
    - Do not stop after the first or second scene. The story must reach its conclusion.
    - Write 5-8 paragraphs covering the full arc. A shorter, polished story is always better
      than a longer one that loses quality.
    - Spend roughly equal effort on each beat. Do not over-describe early scenes and then rush the ending.
    - The final paragraph must be as carefully written as the first.
    - Be concise: advance the plot with every paragraph. Cut unnecessary setting descriptions
      that do not serve the action or characters. Show through dialogue and action, not narration.

    ## Sentence Quality
    - Use short and medium-length sentences. Vary their structure.
    - Never write a paragraph as a single run-on sentence.
    - Never chain participles ("walking along, noticing things, wondering about, feeling the...").
      Break them into separate sentences.
    - Never drop articles (a, an, the). Every noun that needs one must have one.
    - Mix action sentences, dialogue lines, and brief description.
    - Keep descriptions tight: one or two vivid details per sentence, never five.
    - Every paragraph should contain at most 3-5 sentences.

    ## Output
    - Output ONLY the story prose.
    - Do not include titles, author names, "Title:", "Author:", "Content:", separators like "---", or any metadata.
    - Do not add commentary before or after the story.

  story_from_outline_user: |
    Below is the story outline. You must follow every plot beat in order.

    [OUTLINE BEGIN]
    {outline}
    [OUTLINE END]

    Writing request: {query}

    Expand this outline into a complete story.
    Requirements:
    - Cover ALL 5 plot beats from hook through resolution. Do not skip any.
    - Include natural dialogue between characters in at least 3 scenes.
    - Use varied sentence lengths. No run-on paragraphs. No chained participles.
    - Be concise: advance the plot with every paragraph. A shorter polished story is better than a long rambling one.
    - Start with a strong opening sentence.
    - End with a clear, short concluding sentence — not a trailing thought or ellipsis.
    - The final paragraph must be as polished as the first. Do not rush the ending.
    - Output only the story text, nothing else.

#evaluation prompts for the evaluation.py
evaluation:
  # Evaluation prompt with generated story context
  with_story: |
    You are an expert story evaluator. Evaluate the following generated story based on the criteria below.

    ## Generated Story:
    {story}

    ## Evaluation Criteria:
    Please evaluate the story on a scale of 1-10 for each criterion. Give low scores (1-3) if the story is a repetitive loop, starts/ends mid-sentence, or is one long run-on with repeated phrases.

    1. **Coherence** (1-10): Does the story have a clear beginning, middle, and end? Does it flow logically without repetitive loops or confusing transitions?
    2. **Grammar** (1-10): Is the language correct and readable? Penalize run-on sentences and excessive repetition of the same words or phrases.
    3. **Creativity** (1-10): Is the story original and varied? Penalize heavy repetition of the same sentence or phrase (e.g. the same two descriptions repeated).
    4. **Faithfulness** (1-10): How well does the story align with the provided context/source material? (If no context, evaluate internal consistency.)
    5. **Overall** (1-10): Your overall assessment. Give a low score if the text is clearly a generation failure (repetition loop, no real ending, or unreadable run-ons).

    ## Response Format:
    Provide your evaluation as a valid JSON object with the following structure:
    {{
        "coherence": {{
            "score": <1-10>,
            "feedback": "<brief explanation>"
        }},
        "grammar": {{
            "score": <1-10>,
            "feedback": "<brief explanation>"
        }},
        "creativity": {{
            "score": <1-10>,
            "feedback": "<brief explanation>"
        }},
        "faithfulness": {{
            "score": <1-10>,
            "feedback": "<brief explanation>"
        }},
        "overall": {{
            "score": <1-10>,
            "feedback": "<brief explanation>"
        }},
        "conclusion": "<2-3 sentence overall summary of the evaluation>",
        "suggestions": ["<improvement suggestion 1>", "<improvement suggestion 2>", ...]
    }}

    IMPORTANT: Return ONLY the JSON object, no additional text.

  # Evaluation prompt with generated summary context
  with_summary: |
    You are an expert story evaluator. Read the whole story below, then evaluate the created summary based on the following criteria.

    ## Whole story (source):
    {story}

    ## Summary to evaluate:
    {summary}

    ## Evaluation Criteria:
    Please evaluate the summary on a scale of 1-10 for each criterion:

    1. **Coherence** (1-10): How well does the story flow logically? Are there any contradictions or confusing transitions?
    2. **Grammar** (1-10): How correct and polished is the language? Consider spelling, punctuation, and sentence structure.
    3. **Faithfulness** (1-10): How well does the summary align with the story?
    4. **Overall** (1-10): Your overall assessment of the summary quality.

    ## Response Format:
    Provide your evaluation as a valid JSON object with the following structure:
    {{
        "coherence": {{
            "score": <1-10>,
            "feedback": "<brief explanation>"
        }},
        "grammar": {{
            "score": <1-10>,
            "feedback": "<brief explanation>"
        }},
        "faithfulness": {{
            "score": <1-10>,
            "feedback": "<brief explanation>"
        }},
        "overall": {{
            "score": <1-10>,
            "feedback": "<brief explanation>"
        }},
        "conclusion": "<2-3 sentence overall summary of the evaluation>",
        "suggestions": ["<improvement suggestion 1>", "<improvement suggestion 2>", ...]
    }}

    IMPORTANT: Return ONLY the JSON object, no additional text.
